<div class="section page-header white">
    <div class="gradient-container container-fluid">
        <div class="container">
            <h1>EXPANDING IMAGES</h1>
        </div>

        <div class="created">
            <div class="con">
                <span class="title">CREATED</span>
                <span class="day">18 <span class="ago">MONTHS <br>AGO</span></span>
            </div>
        </div>
        <a class="c-button skip-to-demo-btn" href="#ei-demo" du-smooth-scroll offset="70" duration="1000">Skip to demo <span class="sprite skip"></span></a>
    </div>
</div>

<div class="section white padding-top-120 padding-bottom-120">
    <div class="container">
        <h2 class="margin-bottom-60">Concept</h2>
        <div class="row margin-bottom-70">
            <div class="col-md-4">
                <p>
                    With standard Lightbox plugins clicking on the thumbnail gets the name of the
                    image then changes the src and the larger images is appended
                    to the page.
                </p>
                <p>
                    I wanted this to feel like a gallery found on a mobile in particular
                    ios. Photos on ios has meaningful animations. The thumbnail expanded to
                    the center of screen then when you close it, it's animated back.
                </p>
            </div>
            <div class="col-md-4" scroll-trigger>
                <div class="css-iphone">
                    <div class="speaker"></div>
                    <div class="content">

                        <div class="screen example_1" >
                            <span class="touch-sim" ng-class="{touch_sim_animation: trigger}"></span>
                            <div class="thumbnail-example" ng-class="{expand_example: trigger}"></div>
                            <div class="lg-image-example" ng-class="{show_lg_1: trigger}"></div>
                        </div>
                    </div>
                    <div class="button"></div>
                </div>

            </div>
            <div class="col-md-4">
                <p>
                    Here clicking the thumbnail expands it to the center of the device. First
                    the thumbnail is cloned then the opacity of the thumbnail is set to 0 (no animation).
                    The clone is placed on the invisible thumbnail it is then animated to
                    the center and scale to the width of the device.
                </p>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">
                <p>
                    When the large image is closed it is removed and the clone
                    animates back to it's origin and its also removed, then
                    thumbnails opacity is returned to 1 without animation.
                </p>
            </div>
            <div class="col-md-4" scroll-trigger>
                <div class="css-iphone">
                    <div class="speaker"></div>
                        <div class="content">
                            <div class="screen example_2">
                                <span class="touch-sim-2" ng-class="{touch_sim_animation_2: trigger }"></span>
                                <div class="thumbnail-example-2" ng-class="{expand_example_2: trigger }"></div>
                                <div class="lg-image-example-2" ng-class="{hide_lg_2: trigger }"></div>
                            </div>
                        </div>
                    <div class="button"></div>
                </div>
            </div>
            <div class="col-md-4">
                <p>
                    This gives the illusion that the thumbnails has moved
                    but it serves as a placeholder so the markup elements
                    stay were they are during the animation.
                </p>
            </div>
        </div>
    </div>
</div>

<div class="gradient-separator"></div>

<div class="section white padding-top-120 padding-bottom-120">
    <div class="container">
        <h4 class="margin-bottom-60"><small>01</small> Getting large image</h4>
        <div class="row">

            <div class="col-md-5">
                <p>
                    I reused this code from a light gallery I made. When clicking on the thumbnail we get its large image src.
                </p>

                <div class="title-card color-2 code-example">
                    <h5>JS</h5>
                    <p>
                        <span class="css-class"><span class="purple">var</span> src <span class="turquoise">=</span><span class="red"> $this</span>.<span class="blue">attr</span>(<span class="green">'src'</span>);</span>
                        <span class="css-class"><span class="purple">var</span> imgName <span class="turquoise">=</span> <span class="red">src</span>.<span class="turquoise">match</span>(<span class="green">/</span><span class="orange">.</span><span class="turquoise">*\/(</span><span class="orange">.</span><span class="turquoise">*)</span><span class="purple">$</span><span class="green">/</span>)[<span class="orange">1</span>];</span>
                        <span class="css-class"><span class="purple">var</span> largeImgPath <span class="turquoise">=</span> <span class="green">'images/lg/'</span> <span class="turquoise">+</span> imgName;</span>
                    </p>
                </div>
                <p class="code-example-annotation">
                    So the appended image src is now:<br>
                    <span class="green">image/lg/</span> thumbnail-name.jpg
                </p>
            </div>
        </div>
    </div>
</div>

<div class="gradient-separator"></div>

<div class="section white padding-top-120 padding-bottom-120">
    <div class="container">
        <h4 class="margin-bottom-60"><small>02</small> Scaling the Clone</h4>
        <div class="row">
            <div class="col-md-4" scroll-trigger>
                <div class="css-iphone">
                    <div class="speaker"></div>
                    <div class="content">
                        <div class="screen example_3">
                            <div class="thumbnail-example-3" ng-class="{scale_thumbnail: trigger}"></div>
                        </div>
                    </div>
                    <div class="button"></div>
                </div>

            </div>
            <div class="col-md-4">
                <p>
                    First I made a clone of the thumbnail and made the thumbnail opacity 0.
                    The clone would be fixed on top of the invisible thumbnail.
                </p>
            </div>
            <div class="col-md-4">
                <p class="margin-bottom-30">
                    To scale the clone so that it was the same as the width of the
                    device I needed the ratio or scale factor of the width of the
                    of the device and clone.
                </p>
                <div class="fraction panel">
                    <h6>Scale ratio</h6>
                    <p>browser width</p>
                    <p>device width</p>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="gradient-separator"></div>

<div class="section white padding-bottom-120 padding-top-120">
    <div class="container">
        <h4 class="margin-bottom-60"><small>03</small> Centering the Clone</h4>
        <div class="row">
            <div class="col-md-4">
                <p>
                    Once the transition to the center is complete the large image is appended to the center.
                </p>
            </div>
            <div class="col-md-4" scroll-trigger>
                <div class="css-iphone">
                    <div class="speaker"></div>
                    <div class="content">
                        <div class="screen example_4">
                            <div class="thumbnail-example-4" ng-class="{center_thumbnail: trigger}"></div>
                        </div>
                    </div>
                    <div class="button"></div>
                </div>
            </div>
            <div class="col-md-4">
                <p>
                    To get the clone to the center I needed to find the coordinates of the
                    center of the screen where the thumbnail would be if it was fixed at the
                    center. The difference between the browser height and thumbnail height divide
                    by 2 and same for widths respectively would give me the coordinates.
                </p>
                <p>
                    So now the difference between the fixed center (x, y) and the absolute position
                    of the thumbnail would give me the transform for the clone.
                </p>
            </div>
        </div>
    </div>
</div>

<div class="gradient-separator"></div>

<div class="section white padding-top-120 padding-bottom-120">
    <div class="container" id="ei-demo">
        <h3 class="margin-bottom-60">Demo</h3>
        <div class="row">
            <div class="col-xs-6 col-sm-3 col-md-3">
                <img class="thumbnails" ng-src="images/thumbnails/astonMartinVulcanBack.jpg">
            </div>
            <div class="col-xs-6 col-sm-3 col-md-3">
                <img class="thumbnails" ng-src="images/thumbnails/astonMartinVulcanSide.jpg">
            </div>
            <div class="col-xs-6 col-sm-3 col-md-3">
                <img class="thumbnails" ng-src="images/thumbnails/Nozem_Amsterdam_Honda_CX500_Cafe_Racer.jpg">
            </div>
            <div class="col-xs-6 col-sm-3 col-md-3">
                <img class="thumbnails" ng-src="images/thumbnails/Nozem_Amsterdam_Honda_CX500_Cafe_Racer_side.jpg">
            </div>
        </div>
    </div>
</div>

<script>

    //expanding image
    $('.thumbnails').on('tap', function(){
        //disable scroll

        $('body').addClass('no-scroll');

        var $this = $(this);
        var clone = $this.clone().addClass('clone').appendTo('body');
        $this.css({'opacity':'0'});
        var underlay = $('<div class="underlay"><div class="loading"></div></div>');

        var browserHeight = $(window).height();
        var browserWidth = $(window).width();
        var thumbnailHeight = $this.height();
        var thumbnailWidth = $this.width();
        var cloneScaleTo = (browserWidth/thumbnailWidth).toFixed(2);

        var fixedTopPos = 0.5*(browserHeight - thumbnailHeight);
        var fixedLeftPos = 0.5*(browserWidth - thumbnailWidth);
        var absoluteTopPos = $this.offset().top - $(window).scrollTop();
        var absoluteLeftPos = $this.offset().left;
        var animateToX = (fixedLeftPos - absoluteLeftPos).toFixed(0);
        var animateToY = (fixedTopPos - absoluteTopPos).toFixed(0);

        var src = $this.attr('src');
        var imgName = src.match(/.*\/(.*)$/)[1];
        var largeImgPath = 'images/lg/' + imgName;
        var transitionEnd = 'webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend';
        var translate = 'translate3d('+ animateToX +'px' +','+ animateToY +'px'+',0) scale('+ cloneScaleTo +')';

        $('body').append(underlay);
        $('.underlay').append('<img src="'+ largeImgPath +'">');

        $('.underlay img').load(function(){
            $('.loading').remove();
            $('.underlay img').css({'opacity':'0'});
        });

        clone.css({
            'z-index': '5050',
            'position':'fixed',
            'width': thumbnailWidth+'px',
            'left': absoluteLeftPos+'px',
            'top': absoluteTopPos+'px',
            'opacity':'1',
            '-webkit-transform': translate,
            '-moz-transform': translate,
            '-ms-transform': translate,
            '-o-transform': translate,
            'transform': translate
        })
        .one(transitionEnd, function() {
            $('.underlay img').css({'opacity':'1'});
        });

        $('.underlay').on('tap', function(){
            $('.underlay').remove();
            clone.css({
                '-webkit-transition-duration': '0.3s',
                '-moz-transition-duration': '0.3s',
                '-ms-transition-duration': '0.3s',
                '-o-transition-duration': '0.3s',
                'transition-duration': '0.3s',
                'z-index':'3000',
                'opacity':'1',
                '-webkit-transform': 'scale(1)',
                '-moz-transform': 'scale(1)',
                '-ms-transform': 'scale(1)',
                '-o-transform': 'scale(1)',
                'transform': 'scale(1)'
            })
            .one(transitionEnd, function() {
                clone.remove();
                $this.css({'opacity':'1'});
                $('body').removeClass('no-scroll');
            });
        });

        $(window).on('resize', function(){
            clone.remove();
            $('.underlay').remove();
            $this.css({'opacity':'1'});
            $('body').removeClass('no-scroll');
        });
    });

    //End expanding image
</script>
